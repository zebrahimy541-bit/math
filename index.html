<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>آزمایشگاه کلاس‌بندی اعداد</title>
  <style>
    :root {
      --bg: #0f172a;
      --card: #111827;
      --text: #e5e7eb;
      --accent: #22d3ee;
      --muted: #9ca3af;
      --ok: #10b981;
      --warn: #f59e0b;
      --err: #ef4444;
      --chip: #1f2937;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; font-family: Vazirmatn, system-ui, Arial;
      background: radial-gradient(1200px 800px at 70% -20%, #0ea5e9 0%, transparent 40%),
                  radial-gradient(800px 500px at -10% 120%, #22d3ee 0%, transparent 35%), var(--bg);
      color: var(--text);
    }
    .container { max-width: 840px; margin: 0 auto; padding: 32px 20px 60px; }
    header { text-align: center; margin-bottom: 24px; }
    h1 { margin: 0 0 6px; font-size: 28px; letter-spacing: -0.3px; }
    p.lead { margin: 0; color: var(--muted); }
    .card {
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
      border: 1px solid rgba(255,255,255,0.12);
      backdrop-filter: blur(6px);
      border-radius: 16px; padding: 20px; margin-top: 18px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.35);
    }
    label { display: block; margin-bottom: 8px; font-weight: 600; }
    .row { display: grid; grid-template-columns: 1fr auto; gap: 12px; }
    input[type="text"] {
      width: 100%; padding: 12px 14px; border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.15);
      background: rgba(17,24,39,0.6); color: var(--text);
      outline: none;
    }
    input[type="text"]::placeholder { color: #cbd5e1; }
    input[type="text"]:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(34, 211, 238, 0.25); }
    button {
      padding: 12px 16px; border-radius: 12px; border: none; cursor: pointer;
      background: linear-gradient(90deg, #22d3ee, #0ea5e9);
      color: #0b1020; font-weight: 700;
    }
    button.secondary {
      background: transparent; color: var(--text);
      border: 1px solid rgba(255,255,255,0.18);
    }
    .grid { display: grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap: 10px; margin-top: 14px; }
    @media (max-width: 640px) { .row { grid-template-columns: 1fr; } .grid { grid-template-columns: 1fr; } }
    .result { margin-top: 16px; line-height: 1.9; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; }
    .muted { color: var(--muted); }
    .error { color: var(--err); font-weight: 600; }
    .ok { color: var(--ok); font-weight: 600; }
    .chips { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px; }
    .chip {
      background: var(--chip); border: 1px solid rgba(255,255,255,0.14);
      color: var(--text); border-radius: 999px; padding: 6px 10px; font-size: 13px;
    }
    .chip.primary { background: #0ea5e9; color: #06243a; font-weight: 700; }
    .section-title { font-weight: 700; margin-top: 12px; }
    footer { margin-top: 28px; text-align: center; color: var(--muted); font-size: 13px; }
    .small { font-size: 13px; color: var(--muted); }
    .note { background: rgba(17,24,39,0.45); border: 1px dashed rgba(255,255,255,0.18); border-radius: 12px; padding: 10px 12px; margin-top: 10px; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>آزمایشگاه کلاس‌بندی اعداد</h1>
      <p class="lead">ورودی: عدد طبیعی، صحیح، اعشاری، کسری یا رادیکالی. خروجی: دسته‌بندی با دلیل دقیق.</p>
    </header>

    <section class="card" aria-label="ورودی و خروجی">
      <label for="input">ورودی (مثال‌ها: 5 ، 0 ، -3 ، 3/4 ، -7/2 ، 2.5 ، √2 ، sqrt(16) ، √(50))</label>
      <div class="row">
        <input id="input" type="text" placeholder="عددت رو اینجا وارد کن..." />
        <button id="classifyBtn">کلاس‌بندی</button>
      </div>
      <div class="grid">
        <button id="examplesBtn" class="secondary">نمونه تصادفی</button>
        <button id="clearBtn" class="secondary">پاک‌سازی</button>
        <button id="aboutBtn" class="secondary">راهنمای ورودی</button>
      </div>

      <div id="result" class="result" aria-live="polite"></div>
    </section>

    <section class="card" aria-label="توضیحات مجموعه‌ها">
      <div class="section-title">مجموعه‌ها</div>
      <div class="chips">
        <div class="chip">طبیعی (N): 0, 1, 2, 3, ...</div>
        <div class="chip">صحیح (Z): ..., -2, -1, 0, 1, 2, ...</div>
        <div class="chip">گویا (Q): اعداد به صورت a/b با a,b صحیح و b≠0</div>
        <div class="chip">گنگ (I): حقیقیِ غیرگویا (مثل √2، π)</div>
        <div class="chip">حقیقی (R): همهٔ اعداد روی محور حقیقی</div>
      </div>
      <div class="note small">
        در این آزمایشگاه، عدد طبیعی را «صحیحِ نامنفی (شامل 0)» در نظر می‌گیریم.
      </div>
    </section>

    <footer>
      ساخته‌شده برای تمرین ریاضی پایه نهم — این فایل را به عنوان <span class="mono">index.html</span> در GitHub Pages منتشر کنید.
    </footer>
  </div>

  <script>
    // ابزارهای کمکی
    const normalize = s => (s || "").trim().replace(/[٠-٩]/g, d => "٠١٢٣٤٥٦٧٨٩".indexOf(d));

    function isIntegerLike(n) {
      return Number.isFinite(n) && Math.floor(n) === n;
    }

    function isPerfectSquare(n) {
      if (!Number.isFinite(n) || n < 0) return false;
      const r = Math.sqrt(n);
      return Number.isInteger(r);
    }

    function parseInput(str) {
      const s = normalize(str);
      if (!s) throw new Error("ورودی خالی است.");

      // sqrt(...) یا √(...)
      const sqrtParen = s.match(/^(sqrt|\u221a)\s*\(\s*([+-]?\d+(?:\.\d+)?)\s*\)$/i);
      if (sqrtParen) {
        const rad = Number(sqrtParen[2]);
        if (!isFinite(rad)) throw new Error("رادیکاند معتبر نیست.");
        return { kind: "sqrt", raw: s, radicand: rad, value: rad >= 0 ? Math.sqrt(rad) : NaN };
      }

      // √x بدون پرانتز
      const simpleSqrt = s.match(/^\u221a\s*([+-]?\d+(?:\.\d+)?)$/);
      if (simpleSqrt) {
        const rad = Number(simpleSqrt[1]);
        if (!isFinite(rad)) throw new Error("رادیکاند معتبر نیست.");
        return { kind: "sqrt", raw: s, radicand: rad, value: rad >= 0 ? Math.sqrt(rad) : NaN };
      }

      // کسر a/b
      if (s.includes("/")) {
        const parts = s.split("/").map(p => p.trim());
        if (parts.length !== 2 || parts[0] === "" || parts[1] === "") throw new Error("فرمت کسر نامعتبر است. مثال: 3/4");
        const a = Number(parts[0]), b = Number(parts[1]);
        if (!isFinite(a) || !isFinite(b)) throw new Error("صورت یا مخرج عددی نیست.");
        if (b === 0) throw new Error("تقسیم بر صفر مجاز نیست.");
        return { kind: "fraction", raw: s, a, b, value: a / b };
      }

      // عدد معمولی (صحیح یا اعشاری)
      const num = Number(s.replace(/[٫٬،]/g, "."));
      if (!isFinite(num)) throw new Error("ورودی عددی نیست.");
      return { kind: "number", raw: s, value: num, hadDecimal: s.includes(".") || /[٫٬،]/.test(s) };
    }

    function classify(parsed) {
      // پاسخ استاندارد
      const res = {
        displayValue: null,
        primaryClass: null,
        allSets: [],
        reasonLines: [],
        warnings: []
      };

      // دسته‌بندی بر اساس نوع ورودی
      if (parsed.kind === "sqrt") {
        const x = parsed.radicand;

        if (x < 0) {
          res.displayValue = parsed.raw;
          res.primaryClass = "در مجموعهٔ حقیقی تعریف نمی‌شود";
          res.reasonLines.push("جذرِ عدد منفی در مجموعهٔ حقیقی تعریف ندارد.");
          return res;
        }

        const val = Math.sqrt(x);
        res.displayValue = `√${formatNum(x)} ≈ ${val.toFixed(6)}`;

        if (isPerfectSquare(x)) {
          // مقدار صحیح
          res.allSets.push("حقیقی (R)", "گویا (Q)", "صحیح (Z)");
          if (val >= 0) res.allSets.push("طبیعی (N)");
          res.primaryClass = val >= 0 ? "طبیعی (N)" : "صحیح (Z)";
          res.reasonLines.push("رادیکاند مربعِ کامل است، بنابراین جذر عددی صحیح می‌شود.");
          res.reasonLines.push(`چون مقدار ${formatNum(val)} بدون بخش اعشاری است، در صحیح (Z) و به‌دلیل نامنفی‌بودن، در طبیعی (N) قرار می‌گیرد.`);
        } else {
          res.primaryClass = "گنگ (I)";
          res.allSets.push("حقیقی (R)");
          res.reasonLines.push("رادیکاند مربعِ کامل نیست، پس جذر عددِ گنگ (اصم) است.");
          res.reasonLines.push("اعداد گنگ حقیقی هستند اما به صورت a/b با a,b صحیح قابل نمایش نیستند.");
        }
        return res;
      }

      if (parsed.kind === "fraction") {
        const { a, b, value } = parsed;
        res.displayValue = `${formatNum(a)}/${formatNum(b)} = ${value}`;
        res.primaryClass = isIntegerLike(value) ? (value >= 0 ? "طبیعی (N)" : "صحیح (Z)") : "گویا (Q)";
        res.allSets.push("حقیقی (R)", "گویا (Q)");
        if (isIntegerLike(value)) {
          res.allSets.push("صحیح (Z)");
          if (value >= 0) res.allSets.push("طبیعی (N)");
          res.reasonLines.push("این عدد به صورت a/b با a,b صحیح و b≠0 نوشته شده است، بنابراین گویا (Q) است.");
          if (isIntegerLike(value)) res.reasonLines.push("از آنجا که مقدار نهایی بخش اعشاری ندارد، در صحیح (Z) و در صورت نامنفی بودن، در طبیعی (N) قرار می‌گیرد.");
        } else {
          res.reasonLines.push("این عدد کسری با صورت و مخرج صحیح است، پس گویا (Q) است.");
          res.reasonLines.push("گویاها زیرمجموعهٔ حقیقی‌ها هستند.");
        }
        return res;
      }

      if (parsed.kind === "number") {
        const x = parsed.value;
        res.displayValue = formatNum(x);

        if (isIntegerLike(x)) {
          res.allSets.push("حقیقی (R)", "گویا (Q)", "صحیح (Z)");
          if (x >= 0) res.allSets.push("طبیعی (N)");
          res.primaryClass = x >= 0 ? "طبیعی (N)" : "صحیح (Z)";
          res.reasonLines.push("عدد بدون بخش اعشاری است، پس صحیح (Z) است.");
          if (x >= 0) res.reasonLines.push("به دلیل نامنفی بودن، در طبیعی (N) نیز قرار می‌گیرد.");
          res.reasonLines.push("هر عدد صحیح به صورت a/b نیز قابل نمایش است، بنابراین گویا (Q) و در نتیجه حقیقی (R) است.");
        } else {
          res.primaryClass = "گویا (Q)";
          res.allSets.push("حقیقی (R)", "گویا (Q)");
          if (parsed.hadDecimal) {
            res.reasonLines.push("اعشارِ متناهی است؛ هر اعشار متناهی را می‌توان به صورت کسر نوشت، پس گویا (Q) است.");
          } else {
            res.reasonLines.push("این مقدار اعشاری است و می‌توان آن را به صورت کسرِ دو عدد صحیح نوشت؛ بنابراین گویا (Q) و حقیقی (R) است.");
          }
        }
        return res;
      }

      throw new Error("نوع ورودی ناشناخته است.");
    }

    function formatNum(x) {
      if (typeof x !== "number" || !isFinite(x)) return String(x);
      const s = String(x);
      return s.includes(".") ? Number(x).toString() : s;
    }

    function renderResult(parsed, cls) {
      const resultEl = document.getElementById("result");
      const chipsHtml = (cls.allSets || []).map(tag => {
        const primary = tag === cls.primaryClass ? "primary" : "";
        return `<span class="chip ${primary}">${tag}</span>`;
      }).join("");

      const reasonsHtml = (cls.reasonLines || []).map(line => `<li>${line}</li>`).join("");

      const warningsHtml = (cls.warnings || []).map(w => `<div class="warn">${w}</div>`).join("");

      resultEl.innerHTML = `
        <div><strong>ورودی:</strong> <span class="mono">${parsed.raw ?? formatNum(parsed.value)}</span></div>
        <div><strong>تعبیر/محاسبه:</strong> <span class="mono">${cls.displayValue}</span></div>
        <div class="section-title">دستهٔ اصلی</div>
        <div class="ok">${cls.primaryClass}</div>
        <div class="section-title">عضویت‌ها</div>
        <div class="chips">${chipsHtml || '<span class="chip">—</span>'}</div>
        <div class="section-title">دلیل‌ها</div>
        <ul class="small">${reasonsHtml || '<li class="muted">—</li>'}</ul>
        ${warningsHtml ? `<div class="note">${warningsHtml}</div>` : ""}
      `;
    }

    // کنترل‌های رابط
    const inputEl = document.getElementById("input");
    const resultEl = document.getElementById("result");
    const classifyBtn = document.getElementById("classifyBtn");
    const clearBtn = document.getElementById("clearBtn");
    const examplesBtn = document.getElementById("examplesBtn");
    const aboutBtn = document.getElementById("aboutBtn");

    classifyBtn.addEventListener("click", () => {
      try {
        const parsed = parseInput(inputEl.value);
        const cls = classify(parsed);
        renderResult(parsed, cls);
      } catch (err) {
        resultEl.innerHTML = `<span class="error">${err.message}</span>`;
      }
    });

    clearBtn.addEventListener("click", () => {
      inputEl.value = "";
      resultEl.innerHTML = "";
      inputEl.focus();
    });

    examplesBtn.addEventListener("click", () => {
      const samples = ["5", "0", "-3", "3/4", "-7/2", "2.5", "√2", "sqrt(16)", "√(50)", "12/3", "-0.125"];
      const pick = samples[Math.floor(Math.random() * samples.length)];
      inputEl.value = pick;
      classifyBtn.click();
    });

    aboutBtn.addEventListener("click", () => {
      resultEl.innerHTML = `
        <div class="note">
          <div><strong>قالب‌های ورودی پشتیبانی‌شده:</strong></div>
          <ul class="small">
            <li>صحیح: 5 ، -3 ، 0</li>
            <li>اعشاری متناهی: 2.5 ، 0.125</li>
            <li>کسر: 3/4 ، -7/2 (با مخرجِ غیرصفر)</li>
            <li>رادیکال: √2 ، √(50) ، sqrt(16)</li>
          </ul>
          <div class="small muted">توجه: جذرِ عدد منفی در مجموعهٔ حقیقی تعریف نمی‌شود.</div>
        </div>
      `;
    });

    // اجرای اولیه با یک مثال
    inputEl.value = "√2";
    classifyBtn.click();
  </script>
</body>
</html>
