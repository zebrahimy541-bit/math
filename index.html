<script>
function add(c) {
    document.getElementById("screen").value += c;
}

function clearInput() {
    document.getElementById("screen").value = "";
    document.getElementById("result").innerHTML = "";
}

function convertRadicals(expr) {
    expr = expr.replace(/(\d+(\.\d+)?)?âˆš\((.*?)\)/g, function(match, coeff, _, inner){
        if(!coeff) coeff = 1;
        return "(" + coeff + "*Math.sqrt(" + inner + "))";
    });
    expr = expr.replace(/(\d+(\.\d+)?)?âˆš(\d+(\.\d+)?)/g, function(match, coeff, _, num){
        if(!coeff) coeff = 1;
        return "(" + coeff + "*Math.sqrt(" + num + "))";
    });
    expr = expr.replace(/\^/g, "**"); // ØªØ¨Ø¯ÛŒÙ„ ^ Ø¨Ù‡ ØªÙˆØ§Ù† ÙˆØ§Ù‚Ø¹ÛŒ
    return expr;
}

function isRational(value) {
    if (Number.isInteger(value)) return true;
    for (let d=1; d<=10000; d++){
        let n = value*d;
        if (Math.abs(n - Math.round(n)) < 1e-10) return true;
    }
    return false;
}

function identify() {
    let input = document.getElementById("screen").value;
    let result = document.getElementById("result");

    let safeExpr = convertRadicals(input);

    let value;
    try {
        value = eval(safeExpr);
    } catch {
        result.innerHTML = "âŒ ÙˆØ±ÙˆØ¯ÛŒ Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª.";
        return;
    }

    if (isNaN(value)){
        result.innerHTML = "âŒ ÙˆØ±ÙˆØ¯ÛŒ Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª.";
        return;
    }

    let explanation = `<b>Ù…Ù‚Ø¯Ø§Ø± Ù†Ù‡Ø§ÛŒÛŒ:</b> ${value}<br><br>`;
    explanation += "<b>Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ù‡Ù…Ø±Ø§Ù‡ Ø¯Ù„ÛŒÙ„:</b><br><br>";

    if (Number.isInteger(value) && value >=0){
        explanation += "ğŸŸ¢ <b>Ø·Ø¨ÛŒØ¹ÛŒ</b>: Ú†ÙˆÙ† ØµØ­ÛŒØ­ Ùˆ ØºÛŒØ±Ù…Ù†ÙÛŒ Ø§Ø³Øª.<br><br>";
    }
    if (Number.isInteger(value)){
        explanation += "ğŸŸ£ <b>ØµØ­ÛŒØ­</b>: Ú†ÙˆÙ† Ø¨Ø®Ø´ Ø§Ø¹Ø´Ø§Ø±ÛŒ Ù†Ø¯Ø§Ø±Ø¯.<br><br>";
    }
    if (isRational(value)){
        explanation += "ğŸ”µ <b>Ú¯ÙˆÛŒØ§</b>: Ù‚Ø§Ø¨Ù„ Ù†ÙˆØ´ØªÙ† Ø¨Ù‡ ØµÙˆØ±Øª Ú©Ø³Ø± p/q Ø§Ø³Øª.<br><br>";
    } else {
        explanation += "ğŸ”´ <b>Ú¯Ù†Ú¯</b>: Ø§Ø¹Ø´Ø§Ø± Ù†Ø§Ù…ØªÙ†Ø§Ù‡ÛŒ ØºÛŒØ± Ø¯ÙˆØ±Ù‡â€ŒØ§ÛŒ Ø¯Ø§Ø±Ø¯.<br><br>";
    }
    explanation += "âš« <b>Ø­Ù‚ÛŒÙ‚ÛŒ</b>: Ø±ÙˆÛŒ Ù…Ø­ÙˆØ± Ø§Ø¹Ø¯Ø§Ø¯ Ø­Ù‚ÛŒÙ‚ÛŒ Ù‚Ø±Ø§Ø± Ø¯Ø§Ø±Ø¯.";

    result.innerHTML = explanation;
}

function toggleGuide(){
    let g = document.getElementById("guide");
    g.style.display = (g.style.display==="none") ? "block" : "none";
}
</script>
